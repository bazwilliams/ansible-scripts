- alias: morning_dark_home
  initial_state: true
  trigger:
    platform: state
    entity_id: sensor.house_mode
    to: morning_dark_home
  action:
    - service: hue.hue_activate_scene
      data_template:
        group_name: Front Garden
        scene_name: "{{ states('input_select.front_garden_dimmed_scene') }}"
    - service: hue.hue_activate_scene
      data_template:
        group_name: Terrace
        scene_name: "{{ states('input_select.terrace_dimmed_scene') }}"
    - service: hue.hue_activate_scene
      data:
        group_name: Downstairs Hallway
        scene_name: Morning Variation
    - service: hue.hue_activate_scene
      data:
        group_name: Upstairs Hallway
        scene_name: Morning
    - service: hue.hue_activate_scene
      data:
        group_name: "Living room"
        scene_name: Morning
- alias: morning_dim_home
  initial_state: true
  trigger:
    platform: state
    entity_id: sensor.house_mode
    to: morning_dim_home
  action:
    - service: light.turn_off
      data:
        entity_id:
          - group.front_garden
          - group.terrace
    - service: hue.hue_activate_scene
      data:
        group_name: Downstairs Hallway
        scene_name: Morning Variation
    - service: hue.hue_activate_scene
      data:
        group_name: Upstairs Hallway
        scene_name: Morning
    - service: hue.hue_activate_scene
      data:
        group_name: "Living room"
        scene_name: Morning
- alias: morning_bright_home
  initial_state: true
  trigger:
    platform: state
    entity_id: sensor.house_mode
    to: morning_bright_home
  action:
    - service: light.turn_off
      data:
        entity_id:
          - group.front_garden
          - group.living_room
          - group.terrace
    - service: hue.hue_activate_scene
      data:
        group_name: Downstairs Hallway
        scene_name: Daytime Presence
    - service: hue.hue_activate_scene
      data:
        group_name: Upstairs Hallway
        scene_name: Morning
- alias: morning_very_bright_home
  initial_state: true
  trigger:
    platform: state
    entity_id: sensor.house_mode
    to: morning_very_bright_home
  action:
    - service: light.turn_off
      data:
        entity_id:
          - group.front_garden
          - group.downstairs_hallway
          - group.living_room
          - group.terrace
    - service: hue.hue_activate_scene
      data:
        group_name: Upstairs Hallway
        scene_name: Morning
- alias: daytime_dark_home
  initial_state: true
  trigger:
    platform: state
    entity_id: sensor.house_mode
    to: daytime_dark_home
  action:
    - service: hue.hue_activate_scene
      data_template:
        group_name: Front Garden
        scene_name: "{{ states('input_select.front_garden_dimmed_scene') }}"
    - service: hue.hue_activate_scene
      data_template:
        group_name: Terrace
        scene_name: "{{ states('input_select.terrace_dimmed_scene') }}"
    - service: hue.hue_activate_scene
      data:
        group_name: Downstairs Hallway
        scene_name: Colourful Evening
    - service: hue.hue_activate_scene
      data:
        group_name: Upstairs Hallway
        scene_name: Evening
    - service: hue.hue_activate_scene
      data:
        group_name: "Living room"
        scene_name: "Living Room Evening"
- alias: daytime_dim_home
  initial_state: true
  trigger:
    platform: state
    entity_id: sensor.house_mode
    to: daytime_dim_home
  action:
    - service: light.turn_off
      data:
        entity_id:
          - group.front_garden
          - group.terrace
    - service: hue.hue_activate_scene
      data:
        group_name: Downstairs Hallway
        scene_name: Daytime Presence
    - service: hue.hue_activate_scene
      data:
        group_name: Upstairs Hallway
        scene_name: Daytime Presence
    - service: hue.hue_activate_scene
      data:
        group_name: "Living room"
        scene_name: "Dull Outside"
- alias: daytime_bright_home
  initial_state: true
  trigger:
    platform: state
    entity_id: sensor.house_mode
    to: daytime_bright_home
  action:
    - service: light.turn_off
      data:
        entity_id:
          - group.front_garden
          - group.terrace
          - group.living_room
    - service: hue.hue_activate_scene
      data:
        group_name: Downstairs Hallway
        scene_name: Daytime Presence
    - service: hue.hue_activate_scene
      data:
        group_name: Upstairs Hallway
        scene_name: Daytime Presence
- alias: daytime_very_bright_home
  initial_state: true
  trigger:
    platform: state
    entity_id: sensor.house_mode
    to: daytime_very_bright_home
  action:
    - service: light.turn_off
      data:
        entity_id:
          - group.front_garden
          - group.terrace
          - group.living_room
          - group.downstairs_hallway
    - service: hue.hue_activate_scene
      data:
        group_name: Upstairs Hallway
        scene_name: Daytime Presence
- alias: evening_dark_home
  initial_state: true
  trigger:
    platform: state
    entity_id: sensor.house_mode
    to: evening_dark_home
  action:
    - service: hue.hue_activate_scene
      data_template:
        group_name: Front Garden
        scene_name: "{{ states('input_select.front_garden_dimmed_scene') }}"
    - service: hue.hue_activate_scene
      data_template:
        group_name: Terrace
        scene_name: "{{ states('input_select.terrace_dimmed_scene') }}"
    - service: hue.hue_activate_scene
      data:
        group_name: Downstairs Hallway
        scene_name: Colourful Evening
    - service: hue.hue_activate_scene
      data:
        group_name: Upstairs Hallway
        scene_name: Evening
    - service: hue.hue_activate_scene
      data:
        group_name: "Living room"
        scene_name: "Living Room Evening"
- alias: evening_dim_home
  initial_state: true
  trigger:
    platform: state
    entity_id: sensor.house_mode
    to: evening_dim_home
  action:
    - service: light.turn_off
      data:
        entity_id:
          - group.front_garden
          - group.terrace
    - service: hue.hue_activate_scene
      data:
        group_name: Downstairs Hallway
        scene_name: Daytime Presence
    - service: hue.hue_activate_scene
      data:
        group_name: Upstairs Hallway
        scene_name: Daytime Presence
    - service: hue.hue_activate_scene
      data:
        group_name: "Living room"
        scene_name: "Dull Outside"
- alias: evening_bright_home
  initial_state: true
  trigger:
    platform: state
    entity_id: sensor.house_mode
    to: evening_bright_home
  action:
    - service: light.turn_off
      data:
        entity_id:
          - group.front_garden
          - group.terrace
          - group.living_room
    - service: hue.hue_activate_scene
      data:
        group_name: Downstairs Hallway
        scene_name: Daytime Presence
    - service: hue.hue_activate_scene
      data:
        group_name: Upstairs Hallway
        scene_name: Daytime Presence
- alias: evening_very_bright_home
  initial_state: true
  trigger:
    platform: state
    entity_id: sensor.house_mode
    to: evening_very_bright_home
  action:
    - service: light.turn_off
      data:
        entity_id:
          - group.front_garden
          - group.terrace
          - group.living_room
          - group.downstairs_hallway
    - service: hue.hue_activate_scene
      data:
        group_name: Upstairs Hallway
        scene_name: Bright Outside
- alias: late_evening_dark_home
  initial_state: true
  trigger:
    platform: state
    entity_id: sensor.house_mode
    to: late_evening_dark_home
  action:
    - service: hue.hue_activate_scene
      data_template:
        group_name: Front Garden
        scene_name: "{{ states('input_select.front_garden_dimmed_scene') }}"
    - service: hue.hue_activate_scene
      data_template:
        group_name: Terrace
        scene_name: "{{ states('input_select.terrace_dimmed_scene') }}"
    - service: hue.hue_activate_scene
      data:
        group_name: Downstairs Hallway
        scene_name: Colourful Evening
    - service: hue.hue_activate_scene
      data:
        group_name: Upstairs Hallway
        scene_name: Night
    - service: hue.hue_activate_scene
      data:
        group_name: "Living room"
        scene_name: "Living Room Evening"
- alias: late_evening_dim_home
  initial_state: true
  trigger:
    platform: state
    entity_id: sensor.house_mode
    to: late_evening_dim_home
  action:
    - service: light.turn_off
      data:
        entity_id:
          - group.front_garden
          - group.terrace
    - service: hue.hue_activate_scene
      data:
        group_name: Downstairs Hallway
        scene_name: Daytime Presence
    - service: hue.hue_activate_scene
      data:
        group_name: Upstairs Hallway
        scene_name: Night
    - service: hue.hue_activate_scene
      data:
        group_name: "Living room"
        scene_name: "Dull Outside"
- alias: late_evening_bright_home
  initial_state: true
  trigger:
    platform: state
    entity_id: sensor.house_mode
    to: late_evening_bright_home
  action:
    - service: light.turn_off
      data:
        entity_id:
          - group.front_garden
          - group.terrace
          - group.living_room
    - service: hue.hue_activate_scene
      data:
        group_name: Downstairs Hallway
        scene_name: Daytime Presence
    - service: hue.hue_activate_scene
      data:
        group_name: Upstairs Hallway
        scene_name: Night
- alias: late_evening_very_bright_home
  initial_state: true
  trigger:
    platform: state
    entity_id: sensor.house_mode
    to: late_evening_very_bright_home
  action:
    - service: light.turn_off
      data:
        entity_id:
          - group.front_garden
          - group.terrace
          - group.living_room
          - group.downstairs_hallway
    - service: hue.hue_activate_scene
      data:
        group_name: Upstairs Hallway
        scene_name: Night
- alias: early_night_dark_home
  initial_state: true
  trigger:
    platform: state
    entity_id: sensor.house_mode
    to: early_night_dark_home
  action:
    - service: hue.hue_activate_scene
      data_template:
        group_name: Front Garden
        scene_name: "{{ states('input_select.front_garden_dimmed_scene') }}"
    - service: hue.hue_activate_scene
      data_template:
        group_name: Terrace
        scene_name: "{{ states('input_select.terrace_dimmed_scene') }}"
    - service: hue.hue_activate_scene
      data:
        group_name: Downstairs Hallway
        scene_name: Late Night
    - service: hue.hue_activate_scene
      data:
        group_name: Upstairs Hallway
        scene_name: Night
    - service: hue.hue_activate_scene
      data:
        group_name: "Living room"
        scene_name: "Living Room Evening"
- alias: early_night_dim_home
  initial_state: true
  trigger:
    platform: state
    entity_id: sensor.house_mode
    to: early_night_dim_home
  action:
    - service: light.turn_off
      data:
        entity_id:
          - group.front_garden
          - group.terrace
    - service: hue.hue_activate_scene
      data:
        group_name: Downstairs Hallway
        scene_name: Late Night
    - service: hue.hue_activate_scene
      data:
        group_name: Upstairs Hallway
        scene_name: Night
    - service: hue.hue_activate_scene
      data:
        group_name: "Living room"
        scene_name: "Dull Outside"
- alias: early_night_bright_home
  initial_state: true
  trigger:
    platform: state
    entity_id: sensor.house_mode
    to: early_night_bright_home
  action:
    - service: light.turn_off
      data:
        entity_id:
          - group.front_garden
          - group.terrace
          - group.living_room
    - service: hue.hue_activate_scene
      data:
        group_name: Downstairs Hallway
        scene_name: Late Night
    - service: hue.hue_activate_scene
      data:
        group_name: Upstairs Hallway
        scene_name: Night
- alias: early_night_very_bright_home
  initial_state: true
  trigger:
    platform: state
    entity_id: sensor.house_mode
    to: early_night_very_bright_home
  action:
    - service: light.turn_off
      data:
        entity_id:
          - group.front_garden
          - group.terrace
          - group.living_room
          - group.downstairs_hallway
    - service: hue.hue_activate_scene
      data:
        group_name: Upstairs Hallway
        scene_name: Night
- alias: night_dark_home
  initial_state: true
  trigger:
    platform: state
    entity_id: sensor.house_mode
    to: night_dark_home
  action:
    - service: hue.hue_activate_scene
      data:
        group_name: Downstairs Hallway
        scene_name: Night
    - service: hue.hue_activate_scene
      data:
        group_name: Upstairs Hallway
        scene_name: Night
    - service: light.turn_off
      data:
        entity_id:
          - group.living_room
          - group.front_garden
          - group.terrace
- alias: night_dim_home
  initial_state: true
  trigger:
    platform: state
    entity_id: sensor.house_mode
    to: night_dim_home
  action:
    - service: light.turn_off
      data:
        entity_id:
          - group.front_garden
          - group.terrace
          - group.living_room
    - service: hue.hue_activate_scene
      data:
        group_name: Downstairs Hallway
        scene_name: Night
    - service: hue.hue_activate_scene
      data:
        group_name: Upstairs Hallway
        scene_name: Night
- alias: night_bright_home
  initial_state: true
  trigger:
    platform: state
    entity_id: sensor.house_mode
    to: night_bright_home
  action:
    - service: light.turn_off
      data:
        entity_id:
          - group.front_garden
          - group.terrace
          - group.living_room
    - service: hue.hue_activate_scene
      data:
        group_name: Downstairs Hallway
        scene_name: Night
    - service: hue.hue_activate_scene
      data:
        group_name: Upstairs Hallway
        scene_name: Night
- alias: night_very_bright_home
  initial_state: true
  trigger:
    platform: state
    entity_id: sensor.house_mode
    to: night_very_bright_home
  action:
    - service: light.turn_off
      data:
        entity_id:
          - group.front_garden
          - group.terrace
          - group.living_room
          - group.downstairs_hallway
    - service: hue.hue_activate_scene
      data:
        group_name: Upstairs Hallway
        scene_name: Night

- alias: morning_dark_away
  initial_state: true
  trigger:
    platform: state
    entity_id: sensor.house_mode
    to: morning_dark_away
  action:
    - service: hue.hue_activate_scene
      data_template:
        group_name: Front Garden
        scene_name: "{{ states('input_select.front_garden_dimmed_scene') }}"
    - service: hue.hue_activate_scene
      data_template:
        group_name: Terrace
        scene_name: "{{ states('input_select.terrace_dimmed_scene') }}"
    - service: hue.hue_activate_scene
      data:
        group_name: Downstairs Hallway
        scene_name: Morning Variation Away
    - service: hue.hue_activate_scene
      data:
        group_name: "Living room"
        scene_name: Morning
    - service: light.turn_off
      data:
        entity_id:
          - group.upstairs_hallway
- alias: morning_dim_away
  initial_state: true
  trigger:
    platform: state
    entity_id: sensor.house_mode
    to: morning_dim_away
  action:
    - service: light.turn_off
      data:
        entity_id:
          - group.front_garden
          - group.terrace
          - group.upstairs_hallway
    - service: hue.hue_activate_scene
      data:
        group_name: Downstairs Hallway
        scene_name: Morning Variation Away
    - service: hue.hue_activate_scene
      data:
        group_name: "Living room"
        scene_name: Morning
- alias: morning_bright_away
  initial_state: true
  trigger:
    platform: state
    entity_id: sensor.house_mode
    to: morning_bright_away
  action:
    - service: light.turn_off
      data:
        entity_id:
          - group.front_garden
          - group.terrace
          - group.upstairs_hallway
          - group.downstairs_hallway
          - group.living_room
- alias: morning_very_bright_away
  initial_state: true
  trigger:
    platform: state
    entity_id: sensor.house_mode
    to: morning_very_bright_away
  action:
    - service: light.turn_off
      data:
        entity_id:
          - group.front_garden
          - group.terrace
          - group.upstairs_hallway
          - group.downstairs_hallway
          - group.living_room
- alias: daytime_dark_away
  initial_state: true
  trigger:
    platform: state
    entity_id: sensor.house_mode
    to: daytime_dark_away
  action:
    - service: hue.hue_activate_scene
      data_template:
        group_name: Front Garden
        scene_name: "{{ states('input_select.front_garden_dimmed_scene') }}"
    - service: hue.hue_activate_scene
      data_template:
        group_name: Terrace
        scene_name: "{{ states('input_select.terrace_dimmed_scene') }}"
    - service: hue.hue_activate_scene
      data:
        group_name: Downstairs Hallway
        scene_name: Colourful Evening Away
    - service: light.turn_off
      data:
        entity_id:
          - group.upstairs_hallway
    - service: hue.hue_activate_scene
      data:
        group_name: "Living room"
        scene_name: "Living Room Evening"
- alias: daytime_dim_away
  initial_state: true
  trigger:
    platform: state
    entity_id: sensor.house_mode
    to: daytime_dim_away
  action:
    - service: light.turn_off
      data:
        entity_id:
          - group.front_garden
          - group.terrace
          - group.upstairs_hallway
    - service: hue.hue_activate_scene
      data:
        group_name: Downstairs Hallway
        scene_name: Daytime Presence
    - service: hue.hue_activate_scene
      data:
        group_name: "Living room"
        scene_name: "Dull Outside"
- alias: daytime_bright_away
  initial_state: true
  trigger:
    platform: state
    entity_id: sensor.house_mode
    to: daytime_bright_away
  action:
    - service: light.turn_off
      data:
        entity_id:
          - group.front_garden
          - group.terrace
          - group.living_room
          - group.upstairs_hallway
    - service: hue.hue_activate_scene
      data:
        group_name: Downstairs Hallway
        scene_name: Daytime Presence
- alias: daytime_very_bright_away
  initial_state: true
  trigger:
    platform: state
    entity_id: sensor.house_mode
    to: daytime_very_bright_away
  action:
    - service: light.turn_off
      data:
        entity_id:
          - group.front_garden
          - group.terrace
          - group.living_room
          - group.downstairs_hallway
          - group.upstairs_hallway
- alias: evening_dark_away
  initial_state: true
  trigger:
    platform: state
    entity_id: sensor.house_mode
    to: evening_dark_away
  action:
    - service: hue.hue_activate_scene
      data_template:
        group_name: Front Garden
        scene_name: "{{ states('input_select.front_garden_dimmed_scene') }}"
    - service: hue.hue_activate_scene
      data_template:
        group_name: Terrace
        scene_name: "{{ states('input_select.terrace_dimmed_scene') }}"
    - service: hue.hue_activate_scene
      data:
        group_name: Downstairs Hallway
        scene_name: Colourful Evening Away
    - service: light.turn_off
      data:
        entity_id:
          - group.upstairs_hallway
    - service: hue.hue_activate_scene
      data:
        group_name: "Living room"
        scene_name: "Living Room Evening"
- alias: evening_dim_away
  initial_state: true
  trigger:
    platform: state
    entity_id: sensor.house_mode
    to: evening_dim_away
  action:
    - service: light.turn_off
      data:
        entity_id:
          - group.front_garden
          - group.terrace
          - group.upstairs_hallway
    - service: hue.hue_activate_scene
      data:
        group_name: Downstairs Hallway
        scene_name: Daytime Presence
    - service: hue.hue_activate_scene
      data:
        group_name: "Living room"
        scene_name: "Dull Outside"
- alias: evening_bright_away
  initial_state: true
  trigger:
    platform: state
    entity_id: sensor.house_mode
    to: evening_bright_away
  action:
    - service: light.turn_off
      data:
        entity_id:
          - group.front_garden
          - group.terrace
          - group.living_room
          - group.upstairs_hallway
    - service: hue.hue_activate_scene
      data:
        group_name: Upstairs Hallway
        scene_name: Daytime Presence
- alias: evening_very_bright_away
  initial_state: true
  trigger:
    platform: state
    entity_id: sensor.house_mode
    to: evening_very_bright_away
  action:
    - service: light.turn_off
      data:
        entity_id:
          - group.front_garden
          - group.terrace
          - group.living_room
          - group.downstairs_hallway
          - group.upstairs_hallway
- alias: late_evening_dark_away
  initial_state: true
  trigger:
    platform: state
    entity_id: sensor.house_mode
    to: late_evening_dark_away
  action:
    - service: hue.hue_activate_scene
      data_template:
        group_name: Front Garden
        scene_name: "{{ states('input_select.front_garden_dimmed_scene') }}"
    - service: hue.hue_activate_scene
      data_template:
        group_name: Terrace
        scene_name: "{{ states('input_select.terrace_dimmed_scene') }}"
    - service: hue.hue_activate_scene
      data:
        group_name: Downstairs Hallway
        scene_name: Colourful Evening Away
    - service: light.turn_off
      data:
        entity_id:
          - group.upstairs_hallway
    - service: hue.hue_activate_scene
      data:
        group_name: "Living room"
        scene_name: "Living Room Evening"
- alias: late_evening_dim_away
  initial_state: true
  trigger:
    platform: state
    entity_id: sensor.house_mode
    to: late_evening_dim_away
  action:
    - service: light.turn_off
      data:
        entity_id:
          - group.front_garden
          - group.terrace
          - group.upstairs_hallway
    - service: hue.hue_activate_scene
      data:
        group_name: Downstairs Hallway
        scene_name: Daytime Presence
    - service: hue.hue_activate_scene
      data:
        group_name: "Living room"
        scene_name: "Dull Outside"
- alias: late_evening_bright_away
  initial_state: true
  trigger:
    platform: state
    entity_id: sensor.house_mode
    to: late_evening_bright_away
  action:
    - service: light.turn_off
      data:
        entity_id:
          - group.front_garden
          - group.terrace
          - group.living_room
          - group.upstairs_hallway
    - service: hue.hue_activate_scene
      data:
        group_name: Downstairs Hallway
        scene_name: Daytime Presence
- alias: late_evening_very_bright_away
  initial_state: true
  trigger:
    platform: state
    entity_id: sensor.house_mode
    to: late_evening_very_bright_away
  action:
    - service: light.turn_off
      data:
        entity_id:
          - group.front_garden
          - group.terrace
          - group.living_room
          - group.downstairs_hallway
          - group.upstairs_hallway
- alias: early_night_dark_away
  initial_state: true
  trigger:
    platform: state
    entity_id: sensor.house_mode
    to: early_night_dark_away
  action:
    - service: hue.hue_activate_scene
      data_template:
        group_name: Front Garden
        scene_name: "{{ states('input_select.front_garden_dimmed_scene') }}"
    - service: hue.hue_activate_scene
      data_template:
        group_name: Terrace
        scene_name: "{{ states('input_select.terrace_dimmed_scene') }}"
    - service: light.turn_off
      data:
        entity_id:
          - group.upstairs_hallway
          - group.downstairs_hallway
    - service: hue.hue_activate_scene
      data:
        group_name: "Living room"
        scene_name: "Living Room Evening"
- alias: early_night_dim_away
  initial_state: true
  trigger:
    platform: state
    entity_id: sensor.house_mode
    to: early_night_dim_away
  action:
    - service: light.turn_off
      data:
        entity_id:
          - group.front_garden
          - group.terrace
          - group.upstairs_hallway
          - group.downstairs_hallway
    - service: hue.hue_activate_scene
      data:
        group_name: "Living room"
        scene_name: "Dull Outside"
- alias: early_night_bright_away
  initial_state: true
  trigger:
    platform: state
    entity_id: sensor.house_mode
    to: early_night_bright_away
  action:
    - service: light.turn_off
      data:
        entity_id:
          - group.front_garden
          - group.terrace
          - group.living_room
          - group.upstairs_hallway
          - group.downstairs_hallway
- alias: early_night_very_bright_away
  initial_state: true
  trigger:
    platform: state
    entity_id: sensor.house_mode
    to: early_night_very_bright_away
  action:
    - service: light.turn_off
      data:
        entity_id:
          - group.front_garden
          - group.terrace
          - group.living_room
          - group.downstairs_hallway
          - group.upstairs_hallway
- alias: night_dark_away
  initial_state: true
  trigger:
    platform: state
    entity_id: sensor.house_mode
    to: night_dark_away
  action:
    - service: light.turn_off
      data:
        entity_id:
          - group.living_room
          - group.upstairs_hallway
          - group.downstairs_hallway
          - group.front_garden
          - group.terrace
- alias: night_dim_away
  initial_state: true
  trigger:
    platform: state
    entity_id: sensor.house_mode
    to: night_dim_away
  action:
    - service: light.turn_off
      data:
        entity_id:
          - group.front_garden
          - group.terrace
          - group.living_room
          - group.upstairs_hallway
          - group.downstairs_hallway
- alias: night_bright_away
  initial_state: true
  trigger:
    platform: state
    entity_id: sensor.house_mode
    to: night_bright_away
  action:
    - service: light.turn_off
      data:
        entity_id:
          - group.front_garden
          - group.terrace
          - group.living_room
          - group.upstairs_hallway
          - group.downstairs_hallway
- alias: night_very_bright_away
  initial_state: true
  trigger:
    platform: state
    entity_id: sensor.house_mode
    to: night_very_bright_away
  action:
    - service: light.turn_off
      data:
        entity_id:
          - group.front_garden
          - group.terrace
          - group.living_room
          - group.upstairs_hallway
          - group.downstairs_hallway

- alias: Turn lights off in rooms not covered by house modes
  initial_state: true
  trigger:
    platform: numeric_state
    entity_id: sensor.outside_light_level
    above: 800
    below: 3000
  condition:
    condition: time
    before: "21:00:00"
    after: "08:00:00"
  action:
    - service: light.turn_off
      data:
        entity_id:
          - group.ethans_room
          - group.marcuss_room
          - group.bedroom
          - group.guest_room
          - group.snug

- alias: Wakeup
  initial_state: true
  trigger:
    platform: time
    at: "06:00:00"
  action:
    - service: light.turn_off
      data:
        entity_id:
          - group.ethans_room
          - group.marcuss_room
    - service: media_player.media_pause
      data:
        entity_id:
          - media_player.ethan_s_room
          - media_player.marcus_room

- alias: Kitchen Lights On At Night
  initial_state: true
  condition:
    - condition: numeric_state
      entity_id: sensor.kitchen_light_level
      below: 5
  trigger:
    - platform: state
      entity_id: binary_sensor.kitchen_occupancy
      from: "off"
      to: "on"
  action:
    - service: hue.hue_activate_scene
      data_template:
        group_name: Kitchen
        scene_name: Night

- alias: Kitchen Lights On
  initial_state: true
  condition:
    - condition: numeric_state
      entity_id: sensor.kitchen_light_level
      below: 40
      above: 5
  trigger:
    - platform: state
      entity_id: binary_sensor.kitchen_occupancy
      from: "off"
      to: "on"
  action:
    - service: light.turn_on
      data:
        entity_id:
          - light.worktop_lights
    - service: hue.hue_activate_scene
      data_template:
        group_name: Kitchen
        scene_name: Morning

- alias: Kitchen Lights Off
  initial_state: true
  trigger:
    platform: state
    entity_id: binary_sensor.kitchen_occupancy
    to: "off"
    for:
      minutes: 5
  action:
    - service: light.turn_off
      data:
        entity_id:
          - group.kitchen

- alias: Brighten the Terrace
  initial_state: true
  trigger:
    platform: state
    entity_id: binary_sensor.terrace_motion
    to: "on"
  condition:
    - condition: numeric_state
      entity_id: sensor.outside_light_level
      below: 50
    - condition: state
      entity_id: input_boolean.terrace_scene_saved
      state: "off"
  action:
    - service: scene.create
      data:
        scene_id: terrace_before
        snapshot_entities:
          - group.terrace
    - service: hue.hue_activate_scene
      data_template:
        group_name: Terrace
        scene_name: "{{ states('input_select.terrace_bright_scene') }}"
    - service: input_boolean.turn_on
      entity_id: input_boolean.terrace_scene_saved

- alias: Restore Terrace Lights
  initial_state: true
  condition:
    - condition: numeric_state
      entity_id: sensor.outside_light_level
      below: 50
  trigger:
    platform: state
    entity_id: binary_sensor.terrace_motion
    to: "off"
    for:
      minutes: 5
  action:
    - service: scene.turn_on
      data:
        entity_id: scene.terrace_before
    - service: input_boolean.turn_off
      entity_id: input_boolean.terrace_scene_saved

- alias: Brighten the Front Garden
  initial_state: true
  trigger:
    platform: state
    entity_id: binary_sensor.front_garden_motion_motion
    to: "on"
  condition:
    - condition: numeric_state
      entity_id: sensor.outside_light_level
      below: 50
    - condition: state
      entity_id: input_boolean.front_garden_scene_saved
      state: "off"
  action:
    - service: scene.create
      data:
        scene_id: front_garden_before
        snapshot_entities:
          - light.front_garden
    - service: hue.hue_activate_scene
      data_template:
        group_name: Front Garden
        scene_name: "{{ states('input_select.front_garden_bright_scene') }}"
    - service: input_boolean.turn_on
      entity_id: input_boolean.front_garden_scene_saved

- alias: Restore Front Garden Lights
  initial_state: true
  condition:
    - condition: numeric_state
      entity_id: sensor.outside_light_level
      below: 50
  trigger:
    platform: state
    entity_id: binary_sensor.front_garden_motion_motion
    to: "off"
    for:
      minutes: 2
  action:
    - service: scene.turn_on
      data:
        entity_id: scene.front_garden_before
    - service: input_boolean.turn_off
      entity_id: input_boolean.front_garden_scene_saved

- alias: Turn Power Amp On
  initial_state: true
  trigger:
    - platform: state
      entity_id: media_player.hifi
      to: "playing"
      for:
        seconds: 2
    - platform: state
      entity_id: media_player.hifi
      to: "idle"
      for:
        seconds: 2
    - platform: state
      entity_id: media_player.hifi
      to: "paused"
      for:
        seconds: 2
  action:
    - service: switch.turn_on
      entity_id: switch.power_amplifier

- alias: Turn Power Amp Off
  initial_state: true
  trigger:
    - platform: state
      entity_id: media_player.hifi
      to: "off"
      for:
        seconds: 5
  action:
    - service: switch.turn_off
      entity_id: switch.power_amplifier

- alias: Listening to Music
  initial_state: true
  trigger:
    - platform: template
      value_template: "{{ is_state_attr('media_player.hifi', 'source', 'Playlist') }}"
      for:
        seconds: 2
  action:
    - service: hue.hue_activate_scene
      data:
        group_name: Snug
        scene_name: Chill

- alias: Listening to Records
  initial_state: true
  trigger:
    - platform: template
      value_template: "{{ is_state_attr('media_player.hifi', 'source', 'LP12') }}"
      for:
        seconds: 2
  action:
    - service: hue.hue_activate_scene
      data:
        group_name: Snug
        scene_name: LP12

- alias: Watching the Big Screen
  initial_state: true
  trigger:
    - platform: state
      entity_id: media_player.epson_projector
      to: "on"
  action:
    - service: hue.hue_activate_scene
      data:
        group_name: Snug
        scene_name: Movie

- alias: Upstairs Hall Cupboard Door Open
  initial_state: true
  trigger:
    - platform: state
      entity_id: binary_sensor.upstairs_hall_cupboard_door
      to: "on"
  action:
    - service: scene.create
      data:
        scene_id: upstairs_spot_2_before
        snapshot_entities:
          - light.upstairs_spot_2
    - service: light.turn_on
      data:
        entity_id: light.upstairs_spot_2
        color_temp: 153
        brightness: 254

- alias: Upstairs Hall Cupboard Door Closed
  initial_state: true
  trigger:
    - platform: state
      entity_id: binary_sensor.upstairs_hall_cupboard_door
      to: "off"
  action:
    - service: scene.turn_on
      data:
        entity_id: scene.upstairs_spot_2_before

- alias: Snug Lights On
  initial_state: true
  trigger:
    platform: event
    event_type: zha_event
    event_data:
      device_ieee: 00:17:88:01:08:0d:00:be
      unique_id: 00:17:88:01:08:0d:00:be:1:0x0006
      endpoint_id: 1
      cluster_id: 6
      command: "on"
  action:
    - service: hue.hue_activate_scene
      data:
        group_name: Snug
        scene_name: Bright

- alias: Snug Off
  initial_state: true
  trigger:
    platform: event
    event_type: zha_event
    event_data:
      device_ieee: 00:17:88:01:08:0d:00:be
      unique_id: 00:17:88:01:08:0d:00:be:1:0x0006
      endpoint_id: 1
      cluster_id: 6
      command: off_with_effect
  action:
    - service: homeassistant.turn_off
      data:
        entity_id:
          - group.snug

- alias: Guest Room Dim Lights On
  initial_state: true
  condition:
    - condition: state
      entity_id: light.silver_lamp
      state: "off"
  trigger:
    platform: event
    event_type: zha_event
    event_data:
      device_ieee: 00:17:88:01:10:49:e1:d2
      unique_id: 00:17:88:01:10:49:e1:d2:1:0x0006
      endpoint_id: 1
      cluster_id: 6
      command: "on"
  action:
    - service: hue.hue_activate_scene
      data:
        group_name: Guest Room
        scene_name: Dim lamp

- alias: Guest Room Lights All Light On
  initial_state: true
  condition:
    - condition: state
      entity_id: light.silver_lamp
      state: "on"
  trigger:
    platform: event
    event_type: zha_event
    event_data:
      device_ieee: 00:17:88:01:10:49:e1:d2
      unique_id: 00:17:88:01:10:49:e1:d2:1:0x0006
      endpoint_id: 1
      cluster_id: 6
      command: "on"
  action:
    - service: hue.hue_activate_scene
      data:
        group_name: Guest Room
        scene_name: Mid bright

- alias: Guest Room Lights Off
  initial_state: true
  trigger:
    platform: event
    event_type: zha_event
    event_data:
      device_ieee: 00:17:88:01:10:49:e1:d2
      unique_id: 00:17:88:01:10:49:e1:d2:1:0x0006
      endpoint_id: 1
      cluster_id: 6
      command: off_with_effect
  action:
    - service: light.turn_off
      data:
        entity_id:
          - group.guest_room
